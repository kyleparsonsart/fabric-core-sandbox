<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fabric ¬∑ Type Token Sandbox</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-page:        #F6F5F3;
    --bg-surface:     #FFFFFF;
    --bg-surface-2:   #FAFAF9;
    --bg-dark:        #111111;
    --border:         #E8E6E1;
    --text-primary:   #111111;
    --text-secondary: #6B6860;
    --text-tertiary:  #A39F96;
    --text-on-dark:   #F5F4F1;
    --text-muted-dark:#7A7670;
    --accent:         #FF5B35;
    --accent-light:   #FFF1ED;
    --pass:           #1A7A4A;
    --pass-bg:        #F0FAF4;
    --pass-border:    #C0E8D0;
    --fail:           #C8352A;
    --fail-bg:        #FEF3F2;
    --fail-border:    #F5C0BB;
    --advisory:       #7A6020;
    --advisory-bg:    #FDFBF3;
    --advisory-border:#EDE5C0;
    --radius:         5px;
    --radius-lg:      8px;
    --shadow:         0 1px 2px rgba(0,0,0,0.06);
    --shadow-md:      0 2px 8px rgba(0,0,0,0.08);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg-page);
    color: var(--text-primary);
    font-size: 13px;
    line-height: 1.5;
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }

  /* ‚îÄ‚îÄ Nav ‚îÄ‚îÄ */
  .topnav {
    background: var(--bg-surface);
    border-bottom: 1px solid var(--border);
    padding: 0 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 48px;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .nav-left { display: flex; align-items: center; gap: 12px; }

  .apollo-logo { display: flex; align-items: center; gap: 7px; }

  .apollo-mark {
    width: 22px; height: 22px;
    display: flex; align-items: center; justify-content: center;
    font-size: 17px; color: var(--text-primary); line-height: 1;
  }

  .apollo-wordmark {
    font-size: 13.5px; font-weight: 600;
    color: var(--text-primary); letter-spacing: -0.2px;
  }

  .nav-sep { width: 1px; height: 18px; background: var(--border); }

  .nav-breadcrumb { display: flex; align-items: center; gap: 4px; font-size: 12.5px; color: var(--text-secondary); }
  .crumb-sep { color: var(--text-tertiary); }
  .crumb-current { color: var(--text-primary); font-weight: 500; }

  .nav-right { display: flex; align-items: center; gap: 8px; }

  .phase-badge {
    background: var(--accent-light); color: var(--accent);
    border: 1px solid #FFCFBF; border-radius: 20px;
    padding: 2px 9px; font-size: 11px; font-weight: 600;
  }

  /* ‚îÄ‚îÄ Page ‚îÄ‚îÄ */
  .page { max-width: 1180px; margin: 0 auto; padding: 24px 20px 60px; }

  .page-header { margin-bottom: 18px; }
  .page-header h1 { font-size: 19px; font-weight: 600; letter-spacing: -0.4px; margin-bottom: 3px; }
  .page-header p  { color: var(--text-secondary); font-size: 12.5px; }

  /* ‚îÄ‚îÄ Stats ‚îÄ‚îÄ */
  .stats-row { display: flex; gap: 8px; margin-bottom: 14px; }

  .stat {
    background: var(--bg-surface); border: 1px solid var(--border);
    border-radius: var(--radius-lg); padding: 9px 14px;
    display: flex; align-items: baseline; gap: 6px;
  }

  .stat-num { font-size: 18px; font-weight: 600; letter-spacing: -0.3px; line-height: 1; }
  .stat-num.red   { color: var(--fail); }
  .stat-num.amber { color: #B87020; }
  .stat-num.green { color: var(--pass); }
  .stat-label { font-size: 11.5px; color: var(--text-secondary); }

  /* ‚îÄ‚îÄ Controls ‚îÄ‚îÄ */
  .controls-bar {
    background: var(--bg-surface); border: 1px solid var(--border);
    border-radius: var(--radius-lg); padding: 10px 14px;
    display: flex; align-items: center; gap: 14px;
    margin-bottom: 14px; flex-wrap: wrap;
  }

  .ctrl-group { display: flex; align-items: center; gap: 7px; }

  .ctrl-label {
    font-size: 10.5px; font-weight: 600; color: var(--text-tertiary);
    text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap;
  }

  .text-input {
    border: 1px solid var(--border); border-radius: var(--radius);
    padding: 5px 9px; font-size: 12.5px; color: var(--text-primary);
    background: var(--bg-surface-2); width: 210px; outline: none;
    font-family: inherit; transition: border-color 0.1s;
  }
  .text-input:focus { border-color: var(--accent); }

  .seg {
    display: flex; background: var(--bg-page);
    border: 1px solid var(--border); border-radius: var(--radius);
    padding: 2px; gap: 2px;
  }

  .seg-btn {
    padding: 4px 11px; border-radius: 3px; border: none;
    background: transparent; font-size: 12px; font-weight: 500;
    cursor: pointer; color: var(--text-secondary); font-family: inherit;
    transition: all 0.1s; white-space: nowrap;
  }
  .seg-btn.active          { background: var(--bg-surface); color: var(--text-primary); box-shadow: var(--shadow); }
  .seg-btn.dark-btn.active { background: var(--bg-dark); color: var(--text-on-dark); }

  .ctrl-div { width: 1px; height: 22px; background: var(--border); }

  .filter-row { display: flex; gap: 4px; }

  .fpill {
    padding: 3px 10px; border-radius: 20px; border: 1px solid var(--border);
    font-size: 11.5px; font-weight: 500; cursor: pointer;
    background: transparent; color: var(--text-secondary); font-family: inherit; transition: all 0.1s;
  }
  .fpill.active          { background: var(--text-primary); color: #fff; border-color: var(--text-primary); }
  .fpill.f-high.active   { background: var(--fail); border-color: var(--fail); }
  .fpill.f-adv.active    { background: #8A7030; border-color: #8A7030; }

  .color-pickers { display: flex; align-items: center; gap: 7px; }
  .cpicker-group { display: flex; align-items: center; gap: 4px; font-size: 11.5px; color: var(--text-secondary); }
  input[type="color"] {
    width: 24px; height: 24px; border: 1px solid var(--border);
    border-radius: 4px; padding: 2px; cursor: pointer; background: none;
  }

  /* ‚îÄ‚îÄ Column headers ‚îÄ‚îÄ */
  .col-headers {
    display: grid;
    grid-template-columns: 200px 68px 74px 84px 90px 1fr 42px;
    padding: 0 0 4px; margin-bottom: 2px;
  }
  .col-th {
    padding: 0 12px; font-size: 10px; font-weight: 700;
    text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-tertiary);
  }

  /* ‚îÄ‚îÄ Token cards ‚îÄ‚îÄ */
  .tokens-grid { display: flex; flex-direction: column; gap: 6px; }

  .token-card {
    background: var(--bg-surface); border: 1px solid var(--border);
    border-radius: var(--radius-lg); overflow: hidden; transition: box-shadow 0.1s;
  }
  .token-card:hover { box-shadow: var(--shadow-md); }
  .token-card.hidden { display: none; }
  .token-card.priority-high     { border-left: 2px solid var(--fail); }
  .token-card.priority-advisory { border-left: 2px solid var(--advisory-border); }

  .card-row {
    display: grid;
    grid-template-columns: 200px 68px 74px 84px 90px 1fr 42px;
    align-items: center; cursor: pointer; user-select: none; min-height: 44px;
  }
  .card-row:hover { background: var(--bg-surface-2); }

  .card-cell {
    padding: 10px 12px; border-right: 1px solid var(--border);
    font-size: 12.5px; display: flex; align-items: center; min-height: 44px;
  }
  .card-cell:last-child { border-right: none; }

  .token-name {
    font-family: 'SF Mono', 'Fira Code', ui-monospace, monospace;
    font-size: 11.5px; font-weight: 500; color: var(--text-primary);
  }

  .meta-val { color: var(--text-primary); font-size: 12.5px; }

  .wcag-badge {
    display: inline-flex; align-items: center; padding: 2px 7px;
    border-radius: 20px; font-size: 10.5px; font-weight: 600; white-space: nowrap;
  }
  .wcag-large    { background: var(--pass-bg);      color: var(--pass);     border: 1px solid var(--pass-border); }
  .wcag-standard { background: var(--bg-surface-2); color: var(--text-secondary); border: 1px solid var(--border); }

  .pri-badge {
    display: inline-flex; align-items: center; gap: 4px; padding: 2px 7px;
    border-radius: 20px; font-size: 10.5px; font-weight: 600; white-space: nowrap;
  }
  .pri-high     { background: var(--fail-bg);     color: var(--fail);     border: 1px solid var(--fail-border); }
  .pri-advisory { background: var(--advisory-bg); color: var(--advisory); border: 1px solid var(--advisory-border); }
  .pri-pass     { background: var(--pass-bg);     color: var(--pass);     border: 1px solid var(--pass-border); }

  .badges-cell { display: flex; gap: 5px; flex-wrap: wrap; align-items: center; }

  .expand-btn {
    padding: 10px 12px; background: none; border: none; cursor: pointer;
    color: var(--text-tertiary); font-size: 13px;
    display: flex; align-items: center; justify-content: center;
    transition: color 0.1s, transform 0.2s;
  }
  .token-card.expanded .expand-btn { transform: rotate(180deg); color: var(--accent); }

  /* ‚îÄ‚îÄ Expanded panel ‚îÄ‚îÄ */
  .card-panel { display: none; border-top: 1px solid var(--border); }
  .token-card.expanded .card-panel { display: grid; grid-template-columns: 1fr 1fr; }

  .panel-preview {
    padding: 20px; border-right: 1px solid var(--border);
    background: var(--bg-surface); transition: background 0.2s;
  }
  .panel-preview.dark-surface { background: var(--bg-dark); }

  .preview-label {
    font-size: 10px; font-weight: 600; text-transform: uppercase;
    letter-spacing: 0.6px; color: var(--text-tertiary); margin-bottom: 14px;
  }
  .panel-preview.dark-surface .preview-label { color: var(--text-muted-dark); }

  .preview-text { word-break: break-word; transition: color 0.2s; }
  .panel-preview.dark-surface .preview-text { color: var(--text-on-dark); }

  .wcag-live {
    margin-top: 16px; padding: 8px 12px; border-radius: var(--radius);
    font-size: 11.5px; display: flex; align-items: center; gap: 7px;
  }
  .wcag-live.pass { background: var(--pass-bg); color: var(--pass); border: 1px solid var(--pass-border); }
  .wcag-live.fail { background: var(--fail-bg); color: var(--fail); border: 1px solid var(--fail-border); }

  .panel-info { padding: 20px; display: flex; flex-direction: column; gap: 16px; }

  .info-section h4 {
    font-size: 10px; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.6px; color: var(--text-tertiary); margin-bottom: 8px;
  }

  .props-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }

  .prop-item {
    background: var(--bg-surface-2); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 7px 10px;
  }
  .prop-key { font-size: 9.5px; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.4px; margin-bottom: 2px; }
  .prop-val { font-size: 12.5px; font-weight: 600; color: var(--text-primary); font-family: 'SF Mono', monospace; }

  .notes-box {
    background: var(--bg-surface-2); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 10px 12px;
    font-size: 12px; color: var(--text-secondary); line-height: 1.55;
  }
  .notes-box.is-high     { background: var(--fail-bg);     border-color: var(--fail-border);     color: #7A1E1A; }
  .notes-box.is-advisory { background: var(--advisory-bg); border-color: var(--advisory-border); color: var(--advisory); }

  .lh-note {
    display: block; margin-top: 8px; font-size: 11px;
    color: var(--advisory); background: var(--advisory-bg);
    border: 1px solid var(--advisory-border); border-radius: 4px;
    padding: 4px 8px; line-height: 1.5;
  }

  .new-tag {
    font-size: 9.5px; background: #EEF4FF; color: #2563EB;
    border: 1px solid #BFDBFE; border-radius: 3px;
    padding: 1px 5px; margin-left: 5px; font-weight: 600;
    font-family: 'DM Sans', sans-serif;
  }
</style>
</head>
<body>

<nav class="topnav">
  <div class="nav-left">
    <div class="apollo-logo">
      <div class="apollo-mark">‚ú≥</div>
      <span class="apollo-wordmark">Apollo</span>
    </div>
    <div class="nav-sep"></div>
    <div class="nav-breadcrumb">
      <span>Fabric</span>
      <span class="crumb-sep">/</span>
      <span>Core</span>
      <span class="crumb-sep">/</span>
      <span>Tokens</span>
      <span class="crumb-sep">/</span>
      <span class="crumb-current">Typography</span>
    </div>
  </div>
  <div class="nav-right">
    <span class="phase-badge">Phase 1 ¬∑ Typography</span>
  </div>
</nav>

<div class="page">
  <div class="page-header">
    <h1>Type Token Sandbox</h1>
    <p>Preview tokens live, test contrast on any surface, and review WCAG 2.2 AA compliance.</p>
  </div>

  <div class="stats-row">
    <div class="stat"><span class="stat-num red">4</span><span class="stat-label">Needs attention</span></div>
    <div class="stat"><span class="stat-num amber">3</span><span class="stat-label">Advisory notes</span></div>
    <div class="stat"><span class="stat-num green">9</span><span class="stat-label">Passing</span></div>
    <div class="stat"><span class="stat-num">16</span><span class="stat-label">Total tokens</span></div>
  </div>

  <div class="controls-bar">
    <div class="ctrl-group">
      <span class="ctrl-label">Sample text</span>
      <input class="text-input" id="sampleText" type="text" value="The quick brown fox jumps" placeholder="Type to preview‚Ä¶">
    </div>
    <div class="ctrl-div"></div>
    <div class="ctrl-group">
      <span class="ctrl-label">Surface</span>
      <div class="seg">
        <button class="seg-btn active" id="btn-light" onclick="setSurface('light')">Light</button>
        <button class="seg-btn dark-btn" id="btn-dark" onclick="setSurface('dark')">Dark</button>
      </div>
    </div>
    <div class="ctrl-div"></div>
    <div class="ctrl-group">
      <span class="ctrl-label">Custom</span>
      <div class="color-pickers">
        <div class="cpicker-group"><label for="bgColor">BG</label><input type="color" id="bgColor" value="#FFFFFF" oninput="updateCustomColors()"></div>
        <div class="cpicker-group"><label for="fgColor">Text</label><input type="color" id="fgColor" value="#111111" oninput="updateCustomColors()"></div>
      </div>
    </div>
    <div class="ctrl-div"></div>
    <div class="ctrl-group">
      <span class="ctrl-label">Filter</span>
      <div class="filter-row">
        <button class="fpill active"  onclick="filterCards('all',this)">All</button>
        <button class="fpill f-high"  onclick="filterCards('high',this)">üî¥ Needs attention</button>
        <button class="fpill f-adv"   onclick="filterCards('advisory',this)">üü° Advisory</button>
        <button class="fpill"         onclick="filterCards('none',this)">‚úì Passing</button>
      </div>
    </div>
  </div>

  <div class="col-headers">
    <div class="col-th">Token</div>
    <div class="col-th">Size</div>
    <div class="col-th">Line Ht.</div>
    <div class="col-th">Tracking</div>
    <div class="col-th">Weight</div>
    <div class="col-th">Status</div>
    <div class="col-th"></div>
  </div>

  <div class="tokens-grid" id="tokensGrid"></div>
</div>

<script>
const tokens = [
  { name:'display-lg',      size:32, lh:40, ls:-0.5, weight:400, wcag:'large',    priority:'none',
    notes:'V2 uses regular weight ‚Äî original heading-1 was bold (700). Negative tracking may affect legibility for some users with dyslexia, but is not a compliance failure.' },
  { name:'display-sm',      size:28, lh:36, ls:-0.5, weight:400, wcag:'large',    priority:'none',     isNew:true,
    notes:'Net new token ‚Äî sits between the former heading-1 (32) and heading-2 (24). Document intended contexts carefully to prevent misuse at small viewports.' },
  { name:'title-lg',        size:24, lh:32, ls:0,    weight:400, wcag:'large',    priority:'none',
    notes:'V2 uses regular weight ‚Äî original heading-2 was bold (700). Qualifies as large text at 24px/400 (‚â•18pt regular). No issues.' },
  { name:'title-md',        size:20, lh:24, ls:0,    weight:400, wcag:'large',    priority:'none',
    notes:'V2 uses regular weight ‚Äî original heading-3 was bold (700). Qualifies as large text at 20px/400 (‚â•18pt regular). No issues.' },
  { name:'title-sm',        size:16, lh:20, ls:0.5,  weight:400, wcag:'standard', priority:'high',
    notes:'üö® Does NOT qualify as large text at 16px/400. heading-4 was previously 700, which would have qualified for 3:1 ‚Äî engineers migrating from heading-4 may assume the same exemption applies. Must meet 4.5:1 contrast. Do not pair with muted or secondary text colors.' },
  { name:'subtitle-lg',     size:14, lh:18, ls:0.5,  weight:500, wcag:'standard', priority:'advisory',
    notes:'Must meet 4.5:1 contrast at 14px/500.',
    lhNote:'Line height is 1.28√ó ‚Äî below the WCAG-recommended 1.5√ó minimum. Consider increasing to 21px. Not a hard compliance failure.' },
  { name:'subtitle-sm',     size:12, lh:16, ls:0.5,  weight:500, wcag:'standard', priority:'high',
    notes:'üö® 12px is the practical legibility floor. Near-identical to caption-medium (12px/500) ‚Äî evaluate whether this token needs to exist. If retained: must only appear at confirmed 4.5:1 contrast. Never use for critical or actionable content.',
    lhNote:'Line height is 1.33√ó ‚Äî consider increasing to 18px.' },
  { name:'body-lg-regular', size:16, lh:24, ls:0,    weight:400, wcag:'standard', priority:'none',
    notes:'Line height 1.5√ó ‚Äî meets WCAG text spacing recommendation. No issues.' },
  { name:'body-lg-medium',  size:16, lh:24, ls:0,    weight:500, wcag:'standard', priority:'none',
    notes:'Line height 1.5√ó ‚Äî meets WCAG text spacing recommendation. No issues.' },
  { name:'body-lg-bold',    size:16, lh:24, ls:0,    weight:700, wcag:'standard', priority:'none',
    notes:'16px/700 is close to the large text threshold (14pt bold ‚âà 18.66px) but does not qualify. Must still meet 4.5:1.' },
  { name:'body-sm-regular', size:14, lh:20, ls:0,    weight:400, wcag:'standard', priority:'none',
    notes:'Highest-volume legacy token ‚Äî maps to body-2 (43.7% of codebase usage). No issues.',
    lhNote:'Line height 1.43√ó is slightly below the 1.5√ó recommendation. No hard failure, but worth monitoring given usage volume.' },
  { name:'body-sm-medium',  size:14, lh:20, ls:0,    weight:500, wcag:'standard', priority:'advisory',
    notes:'14px/500 does NOT qualify as large text. Designers may conflate weight 500 with bold and assume a 3:1 exemption ‚Äî it does not apply. Must meet 4.5:1. Large text exemption applies only to body-sm-bold.',
    lhNote:'Line height 1.43√ó ‚Äî slightly below 1.5√ó recommendation.' },
  { name:'body-sm-bold',    size:14, lh:20, ls:0,    weight:700, wcag:'large',    priority:'none',
    notes:'14px/700 qualifies as large text (14pt bold threshold). 3:1 contrast applies. The only body-sm token with the large text exemption ‚Äî document this clearly alongside body-sm-medium.' },
  { name:'caption-regular', size:12, lh:16, ls:0,    weight:400, wcag:'standard', priority:'high',
    notes:'üö® 12px/400 is the most accessibility-risky combination in the scale. Strict 4.5:1 with zero exemptions. Must never be used for critical or actionable content. Only use on surfaces where 4.5:1 is confirmed.',
    lhNote:'Line height 1.33√ó ‚Äî consider increasing to 18px.' },
  { name:'caption-medium',  size:12, lh:16, ls:0,    weight:500, wcag:'standard', priority:'high',
    notes:'üö® Near-identical to subtitle-sm (12px/500) ‚Äî evaluate consolidation. If retained: must meet 4.5:1. Never use for critical or actionable content.',
    lhNote:'Line height 1.33√ó ‚Äî consider increasing to 18px.' },
  { name:'caption-bold',    size:12, lh:16, ls:0,    weight:700, wcag:'standard', priority:'high',
    notes:'üö® 12px/700 does NOT qualify as large text ‚Äî 14pt bold threshold is ‚âà18.66px. Even at bold weight, still requires 4.5:1. Same constraints as caption-regular.',
    lhNote:'Line height 1.33√ó ‚Äî consider increasing to 18px.' },
];

let surface = 'light';
let customBg = '#FFFFFF', customFg = '#111111';

function lum(hex) {
  const r=parseInt(hex.slice(1,3),16)/255, g=parseInt(hex.slice(3,5),16)/255, b=parseInt(hex.slice(5,7),16)/255;
  const f=c=>c<=0.03928?c/12.92:Math.pow((c+0.055)/1.055,2.4);
  return 0.2126*f(r)+0.7152*f(g)+0.0722*f(b);
}
function cr(a,b){const l1=lum(a),l2=lum(b);return(Math.max(l1,l2)+0.05)/(Math.min(l1,l2)+0.05);}
function colors(){
  if(surface==='custom') return{bg:customBg,fg:customFg};
  if(surface==='dark')   return{bg:'#111111',fg:'#F5F4F1'};
  return{bg:'#FFFFFF',fg:'#111111'};
}

function buildCards(){
  const grid=document.getElementById('tokensGrid');
  grid.innerHTML='';
  tokens.forEach((t,i)=>{
    const card=document.createElement('div');
    card.className=`token-card priority-${t.priority}`;
    card.dataset.priority=t.priority;
    card.dataset.index=i;

    const wLabel = t.wcag==='large' ? 'Large text ¬∑ 3:1' : 'Standard ¬∑ 4.5:1';
    const wCls   = t.wcag==='large' ? 'wcag-large' : 'wcag-standard';
    const pLabel = t.priority==='high' ? 'üî¥ Needs attention' : t.priority==='advisory' ? 'üü° Advisory' : '‚úì Passing';
    const pCls   = t.priority==='high' ? 'pri-high' : t.priority==='advisory' ? 'pri-advisory' : 'pri-pass';
    const newTag = t.isNew ? '<span class="new-tag">NEW</span>' : '';

    card.innerHTML=`
      <div class="card-row" onclick="toggle(${i})">
        <div class="card-cell"><span class="token-name">${t.name}</span>${newTag}</div>
        <div class="card-cell"><span class="meta-val">${t.size}px</span></div>
        <div class="card-cell"><span class="meta-val">${t.lh}px</span></div>
        <div class="card-cell"><span class="meta-val">${t.ls>=0?'+':''}${t.ls}px</span></div>
        <div class="card-cell"><span class="meta-val">${t.weight}</span></div>
        <div class="card-cell badges-cell">
          <span class="wcag-badge ${wCls}">${wLabel}</span>
          <span class="pri-badge ${pCls}">${pLabel}</span>
        </div>
        <button class="expand-btn" aria-label="Expand">‚ñæ</button>
      </div>
      <div class="card-panel">
        <div class="panel-preview" id="prev-${i}">
          <div class="preview-label">Live Preview</div>
          <div class="preview-text" id="pt-${i}" style="font-size:${t.size}px;line-height:${t.lh}px;letter-spacing:${t.ls}px;font-weight:${t.weight};">The quick brown fox jumps</div>
          <div class="wcag-live" id="wl-${i}">
            <span>¬∑</span><span id="wlt-${i}">Checking‚Ä¶</span>
          </div>
        </div>
        <div class="panel-info">
          <div class="info-section">
            <h4>Token Properties</h4>
            <div class="props-grid">
              <div class="prop-item"><div class="prop-key">Font Size</div><div class="prop-val">${t.size}px</div></div>
              <div class="prop-item"><div class="prop-key">Line Height</div><div class="prop-val">${t.lh}px</div></div>
              <div class="prop-item"><div class="prop-key">Letter Spacing</div><div class="prop-val">${t.ls>=0?'+':''}${t.ls}px</div></div>
              <div class="prop-item"><div class="prop-key">Font Weight</div><div class="prop-val">${t.weight}</div></div>
              <div class="prop-item"><div class="prop-key">LH Ratio</div><div class="prop-val">${(t.lh/t.size).toFixed(2)}√ó</div></div>
              <div class="prop-item"><div class="prop-key">Min. Contrast</div><div class="prop-val">${t.wcag==='large'?'3:1':'4.5:1'}</div></div>
            </div>
          </div>
          <div class="info-section">
            <h4>Notes & Constraints</h4>
            <div class="notes-box ${t.priority==='high'?'is-high':t.priority==='advisory'?'is-advisory':''}">
              ${t.notes}
              ${t.lhNote?`<span class="lh-note">üìê ${t.lhNote}</span>`:''}
            </div>
          </div>
        </div>
      </div>`;
    grid.appendChild(card);
  });
  refreshAll();
}

function toggle(i){
  document.querySelector(`[data-index="${i}"]`).classList.toggle('expanded');
  refresh(i);
}

function refresh(i){
  const t=tokens[i];
  const{bg,fg}=colors();
  const prev=document.getElementById(`prev-${i}`);
  const pt=document.getElementById(`pt-${i}`);
  const wl=document.getElementById(`wl-${i}`);
  const wlt=document.getElementById(`wlt-${i}`);
  if(!prev) return;

  prev.style.background=bg;
  pt.style.color=fg;
  pt.textContent=document.getElementById('sampleText').value||'The quick brown fox jumps';

  const ratio=cr(bg,fg), req=t.wcag==='large'?3:4.5, pass=ratio>=req;
  wl.className=`wcag-live ${pass?'pass':'fail'}`;
  wl.firstElementChild.textContent=pass?'‚úì':'‚úó';
  wlt.textContent=`${ratio.toFixed(2)}:1 ‚Äî ${pass?`Passes AA (min ${req}:1)`:`Fails AA (min ${req}:1)`}`;
  prev.classList.toggle('dark-surface', surface==='dark');
}

function refreshAll(){ tokens.forEach((_,i)=>refresh(i)); }

function setSurface(m){
  surface=m;
  document.getElementById('btn-light').classList.toggle('active',m==='light');
  document.getElementById('btn-dark').classList.toggle('active',m==='dark');
  document.getElementById('bgColor').value=m==='dark'?'#111111':'#FFFFFF';
  document.getElementById('fgColor').value=m==='dark'?'#F5F4F1':'#111111';
  customBg=document.getElementById('bgColor').value;
  customFg=document.getElementById('fgColor').value;
  refreshAll();
}

function updateCustomColors(){
  surface='custom';
  document.getElementById('btn-light').classList.remove('active');
  document.getElementById('btn-dark').classList.remove('active');
  customBg=document.getElementById('bgColor').value;
  customFg=document.getElementById('fgColor').value;
  refreshAll();
}

function filterCards(p,btn){
  document.querySelectorAll('.fpill').forEach(el=>el.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('.token-card').forEach(c=>{
    c.classList.toggle('hidden', p!=='all' && c.dataset.priority!==p);
  });
}

document.addEventListener('DOMContentLoaded',()=>{
  buildCards();
  document.getElementById('sampleText').addEventListener('input',refreshAll);
});
</script>
</body>
</html>
